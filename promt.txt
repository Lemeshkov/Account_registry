üîπ –ü–†–û–ú–¢ –î–õ–Ø –ù–û–í–û–ì–û –ß–ê–¢–ê

–Ø —Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞—é –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–µ—Å—Ç—Ä–∞ —Å—á–µ—Ç–æ–≤.

üì¶ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

Backend: Python (FastAPI), –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ venv, requirements.txt –≤ –∫–æ—Ä–Ω–µ, alembic, .env

Frontend: React

Backend –∏ frontend –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –æ–¥–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (—É–¥–∞–ª—ë–Ω–Ω—ã–π —Ä–∞–±–æ—á–∏–π —Å—Ç–æ–ª, Windows, VM)

üìÑ –ß—Ç–æ —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
1Ô∏è‚É£ –ü–∞—Ä—Å–∏–Ω–≥ –∑–∞—è–≤–æ–∫ (Excel)

Excel-—Ñ–∞–π–ª —É—Å–ø–µ—à–Ω–æ –ø–∞—Ä—Å–∏—Ç—Å—è

–î–∞–Ω–Ω—ã–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ –≤ —Ç–∞–±–ª–∏—Ü–µ –∑–∞—è–≤–æ–∫

–ü–æ–ª—è —Ç–∏–ø–∞ –≥–æ—Å. –Ω–æ–º–µ—Ä, —Ç–µ—Ö–Ω–∏–∫–∞, –ø–æ—Å—Ç–∞–≤—â–∏–∫, –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π ‚Äî —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º—ã–µ

2Ô∏è‚É£ –†–µ–µ—Å—Ç—Ä (Frontend)

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç RegistryPreview.jsx:

–¢–∞–±–ª–∏—Ü–∞ —Å –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–æ–º —Ä–µ–µ—Å—Ç—Ä–∞

–†–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º—ã–µ –ø–æ–ª—è:

–ü–æ—Å—Ç–∞–≤—â–∏–∫ (input)

–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π (input)

–¢–µ—Ö–Ω–∏–∫–∞ (input)

–≥.–Ω (input)

–í—ã–ø–∞–¥–∞—é—â–∏–µ —Å–ø–∏—Å–∫–∏:

–ü–ª–∞—Ç–µ–ª—å—â–∏–∫ (select, –¥–µ—Ñ–æ–ª—Ç: –°–∏–±—É–≥–ª–µ—Å–Ω–∞–±)

–°–∏—Å—Ç–µ–º–∞ —Ä–∞—Å—á–µ—Ç–æ–≤ (select, –¥–µ—Ñ–æ–ª—Ç: –ü—Ä–µ–¥–æ–ø–ª–∞—Ç–∞)

–ü–æ–ª–µ ¬´–£—á—Ç–µ–Ω–æ¬ª –≤—Å–µ–≥–¥–∞ = –î–∞

–ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è CSS-–∫–ª–∞—Å—Å—ã:

.cell-input

.payer-select

–¢–∞–±–ª–∏—Ü–∞ –æ–±—ë—Ä–Ω—É—Ç–∞ –≤ overflow-x: auto

–ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã:

table-layout: fixed —É–±—Ä–∞–Ω —Ç–∞–º, –≥–¥–µ –æ–Ω —Ä–µ–∑–∞–ª —Ç–µ–∫—Å—Ç

ellipsis —É–±—Ä–∞–Ω

nth-child –ø—Ä–∏–≤–µ–¥—ë–Ω –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å —Ä–µ–∞–ª—å–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∫–æ–ª–æ–Ω–æ–∫

üß† Backend: OCR —Å—á–µ—Ç–æ–≤ (–∫–ª—é—á–µ–≤–∞—è —á–∞—Å—Ç—å)
3Ô∏è‚É£ PaddleOCR

–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω PaddleOCR

–ü—Ä–æ–≤–µ—Ä–∫–∞:

python -c "from paddleocr import PaddleOCR; print('PaddleOCR OK')"


‚Äî —Ä–∞–±–æ—Ç–∞–µ—Ç

4Ô∏è‚É£ PDF ‚Üí OCR

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è pdf2image + poppler

PDF ‚Äî —ç—Ç–æ —Å–∫–∞–Ω –±—É–º–∞–∂–Ω–æ–≥–æ —Å—á–µ—Ç–∞

OCR —É—Å–ø–µ—à–Ω–æ –∏–∑–≤–ª–µ–∫–∞–µ—Ç —Ç–µ–∫—Å—Ç

OCR —Ä–µ–∑—É–ª—å—Ç–∞—Ç ‚Äî —Ö–æ—Ä–æ—à–µ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞, –ø—Ä–∏–≥–æ–¥–µ–Ω –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞

–ü—Ä–∏–º–µ—Ä OCR —Ç–µ–∫—Å—Ç–∞ (—Ñ—Ä–∞–≥–º–µ–Ω—Ç):

–°—á–µ—Ç –Ω–∞ –æ–ø–ª–∞—Ç—É ‚Ññ ...

–ü–æ—Å—Ç–∞–≤—â–∏–∫: –û–û–û "–ê–≤—Ç–æ—Å–∫–∞–Ω-–°–µ—Ä–≤–∏—Å", –ò–ù–ù ...

–ò—Ç–æ–≥–æ: 33 900,00

–í —Ç.—á. –ù–î–° (20%): 5649,99

–ë–∞–Ω–∫–æ–≤—Å–∫–∏–µ —Ä–µ–∫–≤–∏–∑–∏—Ç—ã –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç

üéØ –¶–ï–õ–¨ (–ß–¢–û –ù–£–ñ–ù–û –°–î–ï–õ–ê–¢–¨ –î–ê–õ–¨–®–ï)

–ù—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–ª–µ–π –∑–∞—è–≤–∫–∏ –∏–∑ PDF-—Å—á–µ—Ç–∞:

–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ –∏–∑ OCR:

–†–µ–∫–≤–∏–∑–∏—Ç—ã —Å—á–µ—Ç–∞

–ò–ù–ù

—Ä/—Å

–±–∞–Ω–∫

–ö–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç (–ü–æ—Å—Ç–∞–≤—â–∏–∫)

–°—É–º–º–∞

–í —Ç.—á. –ù–î–°

‚öôÔ∏è –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Ä–µ—à–µ–Ω–∏—é

OCR ‚Üí –µ–¥–∏–Ω—ã–π —Ç–µ–∫—Å—Ç

–ü–∞—Ä—Å–∏–Ω–≥ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º –∏ regex, –Ω–µ –ø–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º

–£—á–∏—Ç—ã–≤–∞—Ç—å, —á—Ç–æ:

PDF –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–∞–Ω–∏—Ü (—Å–ª—É–∂–µ–±–∫–∞ + —Å—á–µ—Ç)

–ù—É–∂–Ω–æ –Ω–∞—Ö–æ–¥–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å–æ —Å–ª–æ–≤–∞–º–∏ –°—á–µ—Ç –Ω–∞ –æ–ø–ª–∞—Ç—É

–†–µ–∑—É–ª—å—Ç–∞—Ç –ø–∞—Ä—Å–∏–Ω–≥–∞ ‚Äî dict / JSON

–≠—Ç–∏ –¥–∞–Ω–Ω—ã–µ –¥–æ–ª–∂–Ω—ã:

–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥—Å—Ç–∞–≤–ª—è—Ç—å—Å—è –≤ —Ä–µ–µ—Å—Ç—Ä

–±—ã—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã –¥–ª—è —Ä—É—á–Ω–æ–≥–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ

üìå –ß—Ç–æ –æ–∂–∏–¥–∞—é –æ—Ç —Ç–µ–±—è –≤ –Ω–æ–≤–æ–º —á–∞—Ç–µ

–ü—Ä–µ–¥–ª–æ–∂–∏—Ç—å —Ñ–∏–Ω–∞–ª—å–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É OCR + –ø–∞—Ä—Å–µ—Ä

–ù–∞–ø–∏—Å–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –≤–∏–¥–∞:

parse_invoice_from_pdf(pdf_path) -> dict


–ü–æ–∫–∞–∑–∞—Ç—å, –∫–∞–∫ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–æ –≤ backend (FastAPI)

(–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å fallback, –µ—Å–ª–∏ OCR –Ω–µ —É–≤–µ—Ä–µ–Ω

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å, —è –º–æ–≥—É:

—Å—Ä–∞–∑—É –Ω–∞–ø–∏—Å–∞—Ç—å –≥–æ—Ç–æ–≤—ã–π backend-–º–æ–¥—É–ª—å

–∏–ª–∏ –Ω–∞—á–∞—Ç—å —Å —É–ø—Ä–æ—â—ë–Ω–Ω–æ–≥–æ MVP

üí° –í–∞–∂–Ω–æ: —ç—Ç–æ –Ω–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç, –∞ –ø—Ä–æ–¥–∞–∫—à–Ω-—Ä–µ—à–µ–Ω–∏–µ –ø–æ–¥ —Ä–µ–∞–ª—å–Ω—ã–µ –±—É—Ö–≥–∞–ª—Ç–µ—Ä—Å–∫–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã.


–ë–æ–ª–µ–µ –ø—Ä–æ—Å—Ç–∞—è –≤–µ—Ä—Å–∏—è –±–µ–∑ —Ä–µ–∫—É—Ä—Å–∏–∏ (—Ç–æ–ª—å–∫–æ 2 —É—Ä–æ–≤–Ω—è):
powershell
# –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ—Ä–µ–Ω—å + –ø–µ—Ä–≤—ã–π —É—Ä–æ–≤–µ–Ω—å –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏
Get-ChildItem | ForEach-Object {
    $icon = if($_.PSIsContainer) { "üìÅ " } else { "üìÑ " }
    Write-Host "‚îú‚îÄ‚îÄ $icon$($_.Name)"
    
    if ($_.PSIsContainer) {
        Get-ChildItem $_.FullName | ForEach-Object {
            $subIcon = if($_.PSIsContainer) { "üìÅ " } else { "üìÑ " }
            Write-Host "‚îÇ   ‚îî‚îÄ‚îÄ $subIcon$($_.Name)"
        }
    }
}

-------------------------------------------------------------------------------------
–Ø —Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞—é backend-—Å–∏—Å—Ç–µ–º—É —Ä–µ–µ—Å—Ç—Ä–∞ –ø–ª–∞—Ç–µ–∂–µ–π –Ω–∞ FastAPI + SQLAlchemy + PostgreSQL.
Backend: Python (FastAPI), –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ venv, requirements.txt –≤ –∫–æ—Ä–Ω–µ, alembic, .env

Frontend: React

Backend –∏ frontend –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –æ–¥–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ

üéØ –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã

–°–∏—Å—Ç–µ–º–∞ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è:

–∑–∞–≥—Ä—É–∑–∫–∏ Excel —Å –∑—è–≤–∫–∞–º–∏ 
–∑–∞–≥—Ä—É–∑–∫–∏ PDF-—Å—á–µ—Ç–æ–≤
–∏–∑ —ç—Ç–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –º—ã —Å–æ—Å—Ç–∞–≤–ª—è–µ–º —Ç—Ä–µ—Ç–∏–π -—Ä–µ–µ—Å—Ç—Ä
OCR-—Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è PDF

–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è (matching) –¥–∞–Ω–Ω—ã—Ö –∏–∑ PDF —Å–æ —Å—Ç—Ä–æ–∫–∞–º–∏ —Ä–µ–µ—Å—Ç—Ä–∞

–æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –µ–¥–∏–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ —Ä–µ–µ—Å—Ç—Ä–∞, –æ–±–æ–≥–∞—â—ë–Ω–Ω–æ–π –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ PDF

üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (—É–ø—Ä–æ—â—ë–Ω–Ω–æ)
–û—Å–Ω–æ–≤–Ω–∞—è –º–æ–¥–µ–ª—å

PaymentRegistry

—Å–æ–∑–¥–∞—ë—Ç—Å—è —Ç–æ–ª—å–∫–æ –∏–∑ Excel

—Å–æ–¥–µ—Ä–∂–∏—Ç –ø–ª–∞—Ç—ë–∂–Ω—É—é —Å—Ç—Ä–æ–∫—É

PDF –ù–ï –¥–æ–ª–∂–µ–Ω —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤—É—é —Å—Ç—Ä–æ–∫—É, —Ç–æ–ª—å–∫–æ –¥–æ–ø–æ–ª–Ω—è—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é

–ö–ª—é—á–µ–≤—ã–µ –ø–æ–ª—è:

amount

supplier

vehicle

license_plate

invoice_details (JSON, –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –∏–∑ PDF)

invoice_confidence

imported_batch

–ü–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö
1Ô∏è‚É£ Excel upload

–ø–∞—Ä—Å–∏—Ç—Å—è

—Å–æ–∑–¥–∞—ë—Ç —Å—Ç—Ä–æ–∫–∏ PaymentRegistry

invoice_details = NULL

2Ô∏è‚É£ PDF upload

–∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è OCR

—Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è parsed_invoice (dict)

–∫–ª–∞–¥—ë—Ç—Å—è –≤–æ –≤—Ä–µ–º–µ–Ω–Ω—ã–π –±—É—Ñ–µ—Ä

–ø—ã—Ç–∞–µ—Ç—Å—è –Ω–∞–π—Ç–∏ —Å—Ç—Ä–æ–∫—É Excel

–ø—Ä–∏ —É—Å–ø–µ—Ö–µ ‚Üí –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Å—Ç—Ä–æ–∫—É

üìÇ –ö–ª—é—á–µ–≤—ã–µ —Ñ–∞–π–ª—ã –∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å
backend/main.py

—ç–Ω–¥–ø–æ–∏–Ω—Ç /upload

—Ñ–æ–Ω–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ PDF

–≤—ã–∑–æ–≤ pop_invoices()

–∑–∞–ø—É—Å–∫ –º–∞—Ç—á–∏–Ω–≥–∞

–ù–ï –¥–æ–ª–∂–µ–Ω —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å—Ç—Ä–æ–∫–∏ —Ä–µ–µ—Å—Ç—Ä–∞ –∏–∑ PDF

backend/services/invoice_buffer.py
INVOICE_BUFFER: list[dict]


–≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ —Ä–∞—Å–ø–∞—Ä—Å–µ–Ω–Ω—ã—Ö PDF

add_invoice()

pop_invoices()

backend/services/invoice_matcher.py
try_match_invoice(db, invoice_data)


–∏—â–µ—Ç —Å—Ç—Ä–æ–∫—É PaymentRegistry

–º–∞—Ç—á–∏–Ω–≥ –ø–æ:

license_plate

amount

supplier

–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Å—Ç—Ä–æ–∫—É –∏–ª–∏ None

backend/invoice_parser.py (–∏–ª–∏ –∞–Ω–∞–ª–æ–≥)

OCR

—Ä–∞–∑–±–æ—Ä —Ç–µ–∫—Å—Ç–∞ PDF

—Ñ–æ—Ä–º–∏—Ä—É–µ—Ç:

{
  "data": {
    "supplier": ...
    "total": ...
    "vat": ...
    ...
  },
  "confidence": 0.xx,
  "batch_id": ...
}

backend/crud.py

apply_invoice_ocr_to_registry()

build_registry_from_batch()

–æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–µ—Å—Ç—Ä–∞

–º–∞–ø–ø–∏–Ω–≥ OCR ‚Üí –ø–æ–ª—è —Ä–µ–µ—Å—Ç—Ä–∞

‚úÖ –ß—Ç–æ —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

‚úî OCR PDF —Å—Ç–∞–±–∏–ª–µ–Ω
‚úî –î–∞–Ω–Ω—ã–µ –∏–∑ PDF –ø–∞—Ä—Å—è—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
‚úî Excel –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è
‚úî PDF –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è
‚úî Preview —Ä–∞–±–æ—Ç–∞–µ—Ç
‚úî –û—à–∏–±–∫–∏ —Å —Ç–∏–ø–∞–º–∏ (decimal / float) —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã

‚ö†Ô∏è –û—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ (—É–∂–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞)

‚ùå –ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ Excel –∏ PDF –ø–æ—è–≤–ª—è—é—Ç—Å—è 2 —Å—Ç—Ä–æ–∫–∏ –≤–º–µ—Å—Ç–æ –æ–¥–Ω–æ–π

–ü—Ä–∏—á–∏–Ω–∞:

PDF —Å–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—É—é —Å—Ç—Ä–æ–∫—É PaymentRegistry, –µ—Å–ª–∏ –º–∞—Ç—á–∏–Ω–≥ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª

üéØ –¶–µ–ª–µ–≤–∞—è –ª–æ–≥–∏–∫–∞ (—á—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å)

1Ô∏è‚É£ –ó–∞–ø—Ä–µ—Ç–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä–æ–∫ —Ä–µ–µ—Å—Ç—Ä–∞ –∏–∑ PDF

PDF ‚Üí —Ç–æ–ª—å–∫–æ –¥–æ–ø–æ–ª–Ω—è–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Å—Ç—Ä–æ–∫—É

2Ô∏è‚É£ –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å:

1 —Å—Ç—Ä–æ–∫–∞ = 1 –ø–ª–∞—Ç—ë–∂

Excel ‚Üí –æ—Å–Ω–æ–≤–∞

PDF ‚Üí –æ–±–æ–≥–∞—â–µ–Ω–∏–µ

3Ô∏è‚É£ –£–ª—É—á—à–∏—Ç—å try_match_invoice():

–Ω–∞–¥—ë–∂–Ω—ã–π –º–∞—Ç—á–∏–Ω–≥ –ø–æ amount / supplier / plate

4Ô∏è‚É£ –ß—ë—Ç–∫–æ –æ—Ç—Ä–µ–≥—É–ª–∏—Ä–æ–≤–∞—Ç—å:

–∫–∞–∫–∏–µ –ø–æ–ª—è –∏–∑ PDF –ø–∏—à—É—Ç—Å—è –≤ invoice_details

–∫–∞–∫–∏–µ ‚Äî –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏ (vat_amount, invoice_confidence)

üß© –°–ª–µ–¥—É—é—â–∏–π —à–∞–≥, –∫–æ—Ç–æ—Ä—ã–π –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –≤ —ç—Ç–æ–º —á–∞—Ç–µ

–ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å main.py, crud.py, invoice_matcher.py

–£–±—Ä–∞—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏ –∏–∑ PDF

–ü–µ—Ä–µ–ø–∏—Å–∞—Ç—å –ª–æ–≥–∏–∫—É:

PDF ‚Üí MATCH ‚Üí APPLY ‚Üí COMMIT

–û–ø–∏—Å–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø—Ä–æ–µ–∫—Ç–∞
üü¶ frontend/

Frontend-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ React + Vite.

frontend/src/

main.jsx
–¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ React-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (ReactDOM.createRoot).

App.jsx
–ö–æ—Ä–Ω–µ–≤–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

styles.css / index.css
–ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

components/
React-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ (—Ç–∞–±–ª–∏—Ü—ã, —Ñ–æ—Ä–º—ã, –ø—Ä–µ–≤—å—é —Ä–µ–µ—Å—Ç—Ä–∞ –∏ —Ç.–ø.).

üü¶ backend/

Backend –Ω–∞ FastAPI + SQLAlchemy.

backend/main.py

–ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è FastAPI

–¢–æ—á–Ω–æ –¥–µ–ª–∞–µ—Ç:

—Å–æ–∑–¥–∞—ë—Ç FastAPI() –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

—Å–æ–¥–µ—Ä–∂–∏—Ç —ç–Ω–¥–ø–æ–∏–Ω—Ç /upload

—Å–æ–¥–µ—Ä–∂–∏—Ç —ç–Ω–¥–ø–æ–∏–Ω—Ç /invoice/{batch_id}/preview

—É–ø—Ä–∞–≤–ª—è–µ—Ç –ª–æ–≥–∏–∫–æ–π:

–∑–∞–≥—Ä—É–∑–∫–∏ Excel

–∑–∞–≥—Ä—É–∑–∫–∏ PDF

–∑–∞–ø—É—Å–∫–∞ OCR

–¥–æ–±–∞–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ —Ä–µ–µ—Å—Ç—Ä

—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è preview

‚ö†Ô∏è –í–ê–ñ–ù–û
–ò–º–µ–Ω–Ω–æ –∑–¥–µ—Å—å —Ä–∞–Ω–µ–µ:

—Å–æ–∑–¥–∞–≤–∞–ª–∏—Å—å —Å—Ç—Ä–æ–∫–∏ —Ä–µ–µ—Å—Ç—Ä–∞ –∏–∑ PDF (—á—Ç–æ –≤—ã–∑—ã–≤–∞–ª–æ –¥—É–±–ª–∏)

–∑–∞–ø—É—Å–∫–∞–ª–∞—Å—å —Ñ–æ–Ω–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ PDF

backend/database.py

–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è SQLAlchemy

engine

SessionLocal

Base

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤—Å–µ–º–∏ —Å–ª–æ—è–º–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ë–î.

backend/models.py

SQLAlchemy-–º–æ–¥–µ–ª–∏.

–¢–æ—á–Ω–æ —Å–æ–¥–µ—Ä–∂–∏—Ç:

–º–æ–¥–µ–ª—å PaymentRegistry

–æ–ø–∏—Å–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã —Ä–µ–µ—Å—Ç—Ä–∞ –ø–ª–∞—Ç–µ–∂–µ–π

–ø–æ–ª—è:

amount

supplier

invoice_details

imported_batch

–∏ –¥—Ä.

backend/schemas.py

Pydantic-—Å—Ö–µ–º—ã.

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:

–¥–ª—è –æ—Ç–≤–µ—Ç–æ–≤ API

–¥–ª—è —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –≤ preview

backend/crud.py

CRUD-–ª–æ–≥–∏–∫–∞ –∏ —Å–±–æ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö.

–¢–æ—á–Ω–æ –¥–µ–ª–∞–µ—Ç:

—Å–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä–æ–∫ PaymentRegistry

–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Å—Ç—Ä–æ–∫

—Å–±–æ—Ä–∫—É preview —Ä–µ–µ—Å—Ç—Ä–∞ –ø–æ batch_id

–ò–∑ –ª–æ–≥–æ–≤ –∏–∑–≤–µ—Å—Ç–Ω–æ:

build_registry_from_batch() —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –¥–ª—è preview

apply_invoice_ocr_to_registry() –ø—Ä–∏–º–µ–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ PDF –∫ —Å—Ç—Ä–æ–∫–µ —Ä–µ–µ—Å—Ç—Ä–∞

‚ö†Ô∏è –ó–¥–µ—Å—å —Ä–∞–Ω–µ–µ –≤–æ–∑–Ω–∏–∫–∞–ª–∞ –æ—à–∏–±–∫–∞:

invoice.get("confidence")


–∫–æ–≥–¥–∞ invoice –±—ã–ª —Å—Ç—Ä–æ–∫–æ–π, –∞ –Ω–µ dict.

üü¶ backend/parsers/

–ü–∞—Ä—Å–µ—Ä—ã –≤—Ö–æ–¥–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤.

excel_parser.py

–¢–æ—á–Ω–æ:

—á–∏—Ç–∞–µ—Ç Excel (.xls / .xlsx)

–∏–∑–≤–ª–µ–∫–∞–µ—Ç —Å—Ç—Ä–æ–∫–∏ —Ä–µ–µ—Å—Ç—Ä–∞

–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è PaymentRegistry

invoice_pdf_parser.py

–¢–æ—á–Ω–æ:

–ø—Ä–∏–Ω–∏–º–∞–µ—Ç PDF

–∑–∞–ø—É—Å–∫–∞–µ—Ç OCR

–∏–∑–≤–ª–µ–∫–∞–µ—Ç —Ç–µ–∫—Å—Ç

–≤—ã–¥–µ–ª—è–µ—Ç –∫–ª—é—á–µ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ —Å—á–µ—Ç–∞ (—Å—É–º–º–∞, –ù–î–°, –ò–ù–ù –∏ —Ç.–ø.)

invoice_parser.py

‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ –ø–µ—Ä–µ—Å–µ–∫–∞–µ—Ç—Å—è –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é —Å invoice_pdf_parser.py.

–ü–æ —Ñ–∞–∫—Ç—É:

–∑–∞–Ω–∏–º–∞–µ—Ç—Å—è –ª–æ–≥–∏–∫–æ–π —Ä–∞–∑–±–æ—Ä–∞ –∏–Ω–≤–æ–π—Å–∞

—Å–æ–±–∏—Ä–∞–µ—Ç –∏—Ç–æ–≥–æ–≤—ã–π dict –≤–∏–¥–∞:

{
  "data": {...},
  "confidence": float,
  "batch_id": str
}

pdf_parser.py

–ù–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π –ø–∞—Ä—Å–µ—Ä PDF.

–í–µ—Ä–æ—è—Ç–Ω–æ:

–∏–∑–≤–ª–µ–∫–∞–µ—Ç —Ç–µ–∫—Å—Ç —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü

–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ OCR / invoice_pdf_parser

(–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ—Å–≤–µ–Ω–Ω–æ, –Ω–∞–ø—Ä—è–º—É—é –≤ main –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è)

regex_patterns.py

–ù–∞–±–æ—Ä —Ä–µ–≥—É–ª—è—Ä–Ω—ã—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–π.

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:

–¥–ª—è –ø–æ–∏—Å–∫–∞ —Å—É–º–º

–ò–ù–ù

–Ω–æ–º–µ—Ä–æ–≤

–¥–∞—Ç
–≤ —Ç–µ–∫—Å—Ç–µ PDF.

üü¶ backend/services/

–°–µ—Ä–≤–∏—Å–Ω—ã–π —Å–ª–æ–π ‚Äî –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞.

ocr_service.py

–¢–æ—á–Ω–æ:

–æ–±—ë—Ä—Ç–∫–∞ –Ω–∞–¥ OCR (paddleocr)

–ø—Ä–∏–Ω–∏–º–∞–µ—Ç PDF

–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç

invoice_buffer.py

–í—Ä–µ–º–µ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ —Ä–∞—Å–ø–∞—Ä—Å–µ–Ω–Ω—ã—Ö PDF.

INVOICE_BUFFER: list[dict]


–§—É–Ω–∫—Ü–∏–∏:

add_invoice(invoice)

pop_invoices()

has_invoices()

–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:

–≤—Ä–µ–º–µ–Ω–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ PDF –¥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∫ —Ä–µ–µ—Å—Ç—Ä—É

invoice_matcher.py

–õ–æ–≥–∏–∫–∞ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è PDF ‚Üî Excel.

–¢–æ—á–Ω–æ:

—Ñ—É–Ω–∫—Ü–∏—è try_match_invoice()

–ø—Ä–∏–Ω–∏–º–∞–µ—Ç:

db

invoice_data

batch_id

–∏—â–µ—Ç —Å—Ç—Ä–æ–∫—É PaymentRegistry –±–µ–∑ invoice_details

–ú–∞—Ç—á–∏–Ω–≥:

–ø–æ –≥–æ—Å–Ω–æ–º–µ—Ä—É

–ø–æ —Å—É–º–º–µ

fallback: –µ—Å–ª–∏ –æ—Å—Ç–∞–ª–∞—Å—å 1 —Å—Ç—Ä–æ–∫–∞

üü¶ backend/uploads/

–§–∏–∑–∏—á–µ—Å–∫–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤.

Excel –∏ PDF —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º batch_id

–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è:

OCR

–æ—Ç–ª–∞–¥–∫–∏

–ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏

üü¶ alembic/

–ú–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.

versions/ ‚Äî –≤–µ—Ä—Å–∏–∏ —Å—Ö–µ–º—ã

env.py ‚Äî –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Alembic

üü¶ –ü—Ä–æ—á–∏–µ —Ñ–∞–π–ª—ã

create_app.py
‚ö†Ô∏è –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é (–≤–æ–∑–º–æ–∂–Ω—ã–π –∑–∞–¥–µ–ª –ø–æ–¥ —Ñ–∞–±—Ä–∏–∫—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)

test_ocr.py
–¢–µ—Å—Ç OCR –≤—Ä—É—á–Ω—É—é

requirements.txt / requirements_simple.txt
–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

README.md
–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞

invoice_test.pdf / page_*.png
–¢–µ—Å—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è OCR

üß† –ö–ª—é—á–µ–≤–∞—è –ª–æ–≥–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã (—Å–µ–π—á–∞—Å)

Excel ‚Üí —Å–æ–∑–¥–∞—ë—Ç —Å—Ç—Ä–æ–∫–∏ PaymentRegistry

PDF ‚Üí OCR ‚Üí –ø–∞—Ä—Å–∏–Ω–≥ ‚Üí –¥–∞–Ω–Ω—ã–µ

PDF –¥–æ–ª–∂–µ–Ω:

–Ω–∞—Ö–æ–¥–∏—Ç—å —Å—Ç—Ä–æ–∫—É Excel

–¥–æ–ø–æ–ª–Ω—è—Ç—å –µ—ë

–Ω–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤—É—é

üéØ –°–ª–µ–¥—É—é—â–∏–π –ª–æ–≥–∏—á–µ—Å–∫–∏–π —à–∞–≥

(—É–∂–µ –º–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å –≤ –Ω–æ–≤–æ–º —á–∞—Ç–µ)

–ñ—ë—Å—Ç–∫–æ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª–æ:
PDF –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —Å–æ–∑–¥–∞—ë—Ç PaymentRegistry

–£—Å–∏–ª–∏—Ç—å invoice_matcher.py

–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞—Ç—å –º–∞–ø–ø–∏–Ω–≥ PDF ‚Üí –ø–æ–ª—è —Ä–µ–µ—Å—Ç—Ä–∞

–ù–∞—á–∏–Ω–∞–π —Å —ç—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è.
–°—á–∏—Ç–∞–π, —á—Ç–æ OCR, –±—É—Ñ–µ—Ä –∏ preview —É–∂–µ —Ä–∞–±–æ—Ç–∞—é—Ç.
–¶–µ–ª—å ‚Äî –æ–¥–Ω–∞ —Å—Ç—Ä–æ–∫–∞ –≤ —Ä–µ–µ—Å—Ç—Ä–µ.